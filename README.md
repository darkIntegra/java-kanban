Переработана логика некоторых методов, добавлены тесты по 5 ТЗ
